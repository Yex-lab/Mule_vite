import{bw as m,bA as i,bx as n,a_ as t,b3 as l,cT as d,by as u,bz as s}from"./index-DzR_SryQ.js";const f=n({id:s().optional(),name:s().min(1,"Name is required"),email:s().email("Invalid email address"),firstName:s().optional(),lastName:s().optional(),role:u(["admin","user","moderator"]).optional(),active:d().default(!0)}),y=[{fields:[{name:"name",label:"Full Name",type:"text",required:!0,placeholder:"Enter full name",disabled:!0}]},{fields:[{name:"email",label:"Email Address",type:"email",required:!0,placeholder:"Enter email address",disabled:!0}]},{fields:[{name:"firstName",label:"First Name",type:"text",placeholder:"Enter first name"},{name:"lastName",label:"Last Name",type:"text",placeholder:"Enter last name"}]},{fields:[{name:"role",label:"Role",type:"select",options:[{value:"user",label:"User"},{value:"admin",label:"Admin"},{value:"moderator",label:"Moderator"}]},{name:"active",label:"Active User",type:"checkbox"}]}],N=m({schema:f,fetchFn:async e=>{if(!e)return{};const a=await t.getUser(e);l.debug("=== FETCH USER DATA DEBUG ==="),l.debug("Raw userData from API:",JSON.stringify(a,null,2)),l.debug("Profile object:",JSON.stringify(a.profile,null,2)),l.debug("Profile firstName:",a.profile?.firstName),l.debug("Profile lastName:",a.profile?.lastName),l.debug("Supabase user_metadata:",JSON.stringify(a.supabaseUser?.user_metadata,null,2));const r={id:a.supabaseUser?.id||"",name:`${a.profile?.firstName??""} ${a.profile?.lastName??""}`.trim()||a.supabaseUser?.email?.split("@")[0]||"",email:a.supabaseUser?.email||"",firstName:a.profile?.firstName??"",lastName:a.profile?.lastName??"",role:a.supabaseUser?.user_metadata?.role??"user",active:!!a.supabaseUser?.email_confirmed_at};return l.debug("Transformed form data:",JSON.stringify(r,null,2)),r},createFn:async e=>{const a={email:e.email,user_metadata:{first_name:e.firstName,last_name:e.lastName,role:e.role}};return i(()=>t.createUser(a),{loading:"Creating user...",success:"User created successfully!",error:"Failed to create user. Please try again."})},updateFn:async e=>{if(!e.id)throw new Error("User ID is required for update");let a=e.firstName??"",r=e.lastName??"";if((!a||!r)&&e.name){const o=e.name.trim().split(" ");a=(a||o[0])??"",r=(r||o.slice(1).join(" "))??""}const c={firstName:a,lastName:r};return i(()=>t.updateUser(e.id,c),{loading:"Updating user...",success:"User updated successfully!",error:"Failed to update user. Please try again."})},deleteFn:async e=>i(()=>t.deleteUser(e),{loading:"Deleting user...",success:"User deleted successfully!",error:"Failed to delete user. Please try again."}),invalidateQueries:[["users-v2"],["user"]]}),p=n({email:s().email("Invalid email address"),firstName:s().optional(),lastName:s().optional(),role:u(["admin","user","moderator"]).default("user"),password:s().optional(),email_confirm:d().default(!1)}),g=[{fields:[{name:"email",label:"Email Address",type:"email",required:!0,placeholder:"john.doe@example.com"}]},{fields:[{name:"firstName",label:"First Name",type:"text",placeholder:"John"},{name:"lastName",label:"Last Name",type:"text",placeholder:"Doe"}]},{fields:[{name:"role",label:"Role",type:"select",options:[{value:"user",label:"User"},{value:"admin",label:"Admin"},{value:"moderator",label:"Moderator"}]}]},{fields:[{name:"password",label:"Password (Optional)",type:"password",placeholder:"Leave empty to send magic link"}]},{fields:[{name:"email_confirm",label:"Auto-Confirm User",type:"checkbox",helperText:"Automatically confirm user account without email verification"}]}],U=m({schema:p,fetchFn:async e=>({role:"user"}),createFn:async e=>{const a={email:e.email,password:e.password??void 0,email_confirm:e.email_confirm,user_metadata:{first_name:e.firstName,last_name:e.lastName,role:e.role}};return i(()=>t.createUser(a),{loading:"Creating user...",success:"User created successfully!",error:r=>r?.message?.includes("email")||r?.message?.includes("already exists")?"A user with this email already exists.":"Failed to create user. Please try again."})},updateFn:async e=>{throw new Error("Update not supported in add user dialog")},deleteFn:async e=>{throw new Error("Delete not supported in add user dialog")},invalidateQueries:[["users-v2"],["user"]]});export{g as a,U as b,N as c,y as u};
