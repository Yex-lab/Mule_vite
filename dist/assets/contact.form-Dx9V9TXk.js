import{bw as u,bx as m,by as p,bz as i,bA as r,bg as o}from"./index-DzR_SryQ.js";function h(e){if(!e)return"";const n=e.trim().split(/\s+/),t=n[0].replace(/\D/g,""),c=n[1];if(t.length===10){const a=`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`;return c?`${a} x${c}`:a}if(t.length===11&&t[0]==="1"){const a=`(${t.slice(1,4)}) ${t.slice(4,7)}-${t.slice(7)}`;return c?`${a} x${c}`:a}return e}function $(e){if(!e)return"";const t=e.trim().split(/\s+/)[0].replace(/\D/g,"");return t.length===10?`+1${t}`:t.length===11&&t[0]==="1"?`+${t}`:e}function d(e){if(!e)return"";const n=e.match(/(?:x|ext\.?)\s*(\d+)/i),t=n?n[1]:"",a=e.replace(/[^\d\s]/g,"").trim().split(/\s+/),s=a[0];if(s.length===10)return t?`${s} ${t}`:s;if(s.length===11&&s[0]==="1"){const l=s.slice(1);return t?`${l} ${t}`:l}return s.length===10&&a[1]?`${s} ${a[1]}`:e}const f=m({contactid:i().optional(),firstname:i().min(1,"First name is required"),lastname:i().min(1,"Last name is required"),emailaddress1:i().email("Invalid email address"),telephone1:i().optional(),telephone1_ext:i().optional(),jobtitle:i().optional(),statecode:p(["None","Invited","Registered","Inactive","Blocked"]).optional()}),x=u({schema:f,fetchFn:async e=>{if(!e)return{};const n=await o.getContact(e),t=n.telephone1?.split(" ")||[];return{contactid:n.contactid,firstname:n.firstname??"",lastname:n.lastname??"",emailaddress1:n.emailaddress1??"",telephone1:t[0]?`+1${t[0]}`:"",telephone1_ext:t[1]||"",jobtitle:n.jobtitle??"",statecode:n.statecode||"None"}},createFn:async e=>{const{telephone1_ext:n,...t}=e,c=d(e.telephone1),a=n?`${c} ${n}`:c;return r(()=>o.createContact({...t,telephone1:a}),{loading:"Creating contact...",success:"Contact created successfully!",error:s=>s?.message?.includes("email")||s?.message?.includes("already exists")?"A contact with this email already exists.":"Failed to create contact. Please try again."})},updateFn:async e=>{if(!e.contactid)throw new Error("Contact ID is required for update");return r(async()=>{const{contactid:n,telephone1_ext:t,...c}=e,a=d(e.telephone1),s=t?`${a} ${t}`:a;return o.updateContact(n,{...c,telephone1:s})},{loading:"Updating contact...",success:"Contact updated successfully!",error:n=>n?.message?.includes("email")||n?.message?.includes("already exists")?"A contact with this email already exists.":"Failed to update contact. Please try again."})},deleteFn:async e=>r(()=>o.deleteContact(e),{loading:"Deleting contact...",success:"Contact deleted successfully!",error:"Failed to delete contact. Please try again."}),invalidateQueries:[["contacts"]]});export{x as c,h as f,$ as s};
