import{ar as S,as as z,r as x,at as I,j as t,au as L,av as F,aw as O,T as h,bn as B,u as V,b4 as U,bo as v,b1 as _,bp as Q,I as f,bd as W,S as N,bq as p,br as E,bs as q,bt as G,bu as H,b as T,p as C,bv as $,C as J}from"./index-DzR_SryQ.js";import"./user-add.form-C3IzXE3u.js";import"./contact.form-Dx9V9TXk.js";import{A as K,D as X}from"./actions-cell-D2uG9A6N.js";import{C as R,D as Y}from"./date-cell-CyLLe_kF.js";import{P as Z}from"./page-header-CS2V_FKh.js";import{u as ee}from"./use-translation-Bij3JYAK.js";import"./Tabs-BwSGSZfk.js";import"./Breadcrumbs-CpfBRh9G.js";function se(e){return S("MuiDialogContentText",e)}z("MuiDialogContentText",["root"]);const te=e=>{const{classes:l}=e,n=O({root:["root"]},se,l);return{...l,...n}},oe=L(h,{shouldForwardProp:e=>B(e)||e==="classes",name:"MuiDialogContentText",slot:"Root"})({}),ie=x.forwardRef(function(l,a){const n=I({props:l,name:"MuiDialogContentText"}),{children:d,className:u,...m}=n,i=te(m);return t.jsx(oe,{component:"p",variant:"body1",color:"textSecondary",ref:a,ownerState:m,className:F(i.root,u),...n,classes:i})}),ae=e=>({id:e.id,name:e.name,createdAt:e.createdAt,updatedAt:e.updatedAt,title:e.title,documentType:e.documentType,documentTypeId:e.documentTypeId,primaryContact:e.primaryContact,organization:e.organization,designeesAuthorized:e.designeesAuthorized,signedBy:e.signedBy,statusReason:e.statusReason});function le(){const{t:e}=ee(),l=V(),a=U(),[n,d]=x.useState(!1),[u,m]=x.useState(null),i=v.useQuery(_),c=Array.isArray(i.data)?i.data.map(ae):[],b={active:c.filter(s=>s.statusReason==="Active"||!s.statusReason).length,approved:c.filter(s=>s.statusReason==="Approved").length,pendingReview:c.filter(s=>s.statusReason==="Pending Review").length,overdue:c.filter(s=>s.statusReason==="Overdue").length,rejected:c.filter(s=>s.statusReason==="Rejected").length},g=Q({mutationFn:s=>$.deleteSubmission(s),onSuccess:()=>{v.invalidate?.(),d(!1),m(null)}}),y=s=>{l.push(C.myWorkspace.submission(s.id))},j=s=>{m(s),d(!0)},w=()=>{u&&g.mutate(u.id)},D=[{id:"title",label:e("submissions.columns.title"),sortable:!0,width:200,render:(s,o)=>t.jsx(h,{variant:"body2",sx:{color:a.vars.palette.text.primary,cursor:"pointer","&:hover":{textDecoration:"underline"}},onClick:()=>y(o),children:o.title??o.name})},{id:"documentType",label:e("submissions.columns.type"),sortable:!0,width:250,render:(s,o)=>{const r=o.documentType??"-";return r==="-"?t.jsx(h,{variant:"body2",sx:{color:"text.secondary"},children:"-"}):t.jsx(R,{value:r,color:"default",variant:"outlined"})}},{id:"createdAt",label:e("submissions.columns.submittedOn"),width:110,sortable:!0,render:(s,o)=>t.jsx(Y,{value:o.createdAt})},{id:"signedBy",label:e("submissions.columns.signedBy"),width:120,sortable:!0,render:(s,o)=>o.signedBy??"-"},{id:"statusReason",label:e("submissions.columns.status"),width:100,sortable:!0,render:(s,o)=>{const r=o.statusReason??e("submissions.filters.active"),M=r==="Active"?"info":"success";return t.jsx(R,{value:r,color:M,variant:"outlined"})}},{id:"actions",label:"",width:80,minWidth:80,maxWidth:80,render:(s,o)=>{const r=[{id:"view",label:e("submissions.actions.view"),icon:t.jsx(f,{icon:"solar:eye-bold"}),onClick:()=>y(o)},{id:"delete",label:e("submissions.actions.delete"),icon:t.jsx(f,{icon:"solar:trash-bin-trash-bold"}),onClick:()=>j(o),color:"error"}];return t.jsx(K,{actions:r,moreIcon:t.jsx(f,{icon:"eva:more-vertical-fill"})})}}],A=[{id:"all",label:e("submissions.filters.all"),filter:s=>s},{id:"active",label:e("submissions.filters.active"),filter:s=>s.filter(o=>o.statusReason==="Active"||!o.statusReason),color:"info"},{id:"approved",label:e("submissions.filters.approved"),filter:s=>s.filter(o=>o.statusReason==="Approved"),color:"success"},{id:"pendingReview",label:e("submissions.filters.pendingReview"),filter:s=>s.filter(o=>o.statusReason==="Pending Review"),color:"warning"},{id:"overdue",label:e("submissions.filters.overdue"),filter:s=>s.filter(o=>o.statusReason==="Overdue"),color:"error"},{id:"rejected",label:e("submissions.filters.rejected"),filter:s=>s.filter(o=>o.statusReason==="Rejected"),color:"error"}],P={placeholder:e("dataTable.search"),searchFields:["name","documentType"],filterOptions:[{label:e("submissions.columns.type"),value:"documentType",options:["Display Select Type","Designation Letter (SIMM 5330-A)","Technology Recovery Program Compliance Certification (SIMM 5325-B)","Risk Register and Plan of Action and Milestones (RRPOAM) (5305-C)","System Security Plan (SSP)","Technology Recovery Plan (TRP)"]}]},k=()=>{l.push(C.myWorkspace.submissionUpload)};return t.jsxs(W,{children:[t.jsx(Z,{title:e("submissions.title"),description:e("submissions.description"),breadcrumbs:[{label:e("submissions.breadcrumb.workspace")},{label:e("submissions.breadcrumb.submissions")}],action:{label:e("submissions.upload.title"),onClick:k,icon:t.jsx(f,{icon:"mingcute:add-line"})}}),t.jsxs(N,{direction:"row",spacing:3,sx:{mb:4},children:[t.jsx(p,{borderVisible:!1,value:b.active,loading:i.isLoading,label:e("submissions.stats.active"),icon:"solar:refresh-circle-bold",color:"info",size:"small",layout:"icon-left",sx:{flex:1,"& .MuiTypography-root":{color:a.vars?.palette.text.primary}}}),t.jsx(p,{borderVisible:!1,value:b.approved,loading:i.isLoading,label:e("submissions.stats.approved"),icon:"solar:check-circle-bold",color:"success",size:"small",layout:"icon-left",sx:{flex:1,"& .MuiTypography-root":{color:a.vars?.palette.text.primary}}}),t.jsx(p,{borderVisible:!1,value:b.pendingReview,loading:i.isLoading,label:e("submissions.stats.pendingReview"),icon:"solar:clock-circle-bold",color:"warning",size:"small",layout:"icon-left",sx:{flex:1,"& .MuiTypography-root":{color:a.vars?.palette.text.primary}}}),t.jsx(p,{value:b.overdue,loading:i.isLoading,borderVisible:!1,label:e("submissions.stats.overdue"),icon:"solar:clock-circle-bold",color:"error",size:"small",layout:"icon-left",sx:{flex:1,"& .MuiTypography-root":{color:a.vars?.palette.text.primary}}}),t.jsx(p,{borderVisible:!1,value:b.rejected,loading:i.isLoading,label:e("submissions.stats.rejected"),icon:"solar:close-circle-bold",color:"error",size:"small",layout:"icon-left",sx:{flex:1,"& .MuiTypography-root":{color:a.vars?.palette.text.primary}}})]}),t.jsx(X,{store:{useQuery:()=>({data:c,isLoading:i.isLoading,error:i.error,refetch:i.refetch})},columns:D,getRowId:s=>s.id,filterTabs:A,searchConfig:P,onRowClick:y,labels:{search:e("dataTable.search"),keyword:e("dataTable.keyword"),clear:e("dataTable.clear"),resultsFound:e("dataTable.resultsFound"),dense:e("dataTable.dense"),rowsPerPage:e("dataTable.rowsPerPage")}}),t.jsxs(E,{open:n,onClose:()=>d(!1),children:[t.jsx(q,{children:e("submissions.delete.title")}),t.jsx(G,{children:t.jsx(ie,{children:e("submissions.delete.message",{name:u?.name})})}),t.jsxs(H,{children:[t.jsx(T,{onClick:()=>d(!1),children:e("submissions.delete.cancel")}),t.jsx(T,{variant:"contained",color:"error",onClick:w,disabled:g.isPending,children:g.isPending?e("submissions.delete.deleting"):e("submissions.delete.confirm")})]})]})]})}const re={title:`Submissions | My Workspace - ${J.appName}`};function ye(){return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:re.title}),t.jsx(le,{})]})}export{ye as default};
